.data
    buf = "abcd", 0
    i = buf
    temp = 0

.int
    #0 .in_isr

.ops
    JMP .spin_loop
    HLT

.spin_loop
    DI
    CMP 0
    JZ .out
    EI
    JMP .spin_loop

.out
    CMP 0
    JZ .end
    OUT #1
    JMP .out

.end
    HLT

.in_isr
    IN
    ST temp     ; сохранение ввода
    ST (i)
    LD i
    INC
    ST i
    LD temp
    IRET
